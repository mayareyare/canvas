<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sketch to GIF</title>
    <!-- <link rel="stylesheet" type="text/css" href="canvas.css" /> -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lalezar&family=Noto+Sans+Arabic:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/gif.js@0.2.0/dist/gif.min.js"></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Noto Sans Arabic", sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 20px;
        direction: rtl;
      }
      canvas {
        border: 1px solid #000;
        margin: 10px;
        cursor: crosshair;
      }

      /* // <uniquifier>: Use a unique and descriptive class name
      // <weight>: Use a value from 100 to 900 */

      .noto-sans-arabic {
        font-family: "Noto Sans Arabic", sans-serif;
        font-optical-sizing: auto;
        font-weight: 400;
        font-style: normal;
        font-variation-settings: "wdth" 100;
      }
      /* body {
      background: #ffffff;
      font-family: 'Cairo', Arial, sans-serif; 
      font-size: 16px;
      color: #333;
      direction: rtl; 
    } */

      button {
        font-family: "Noto Sans Arabic", sans-serif;
        background-color: #FF9A22; /* Updated to match the orange in the image */
        color: #FFFFFC;
        border: none;
        padding: 10px 70px;
        border-radius: 50px; /* More rounded corners like in the image */
        cursor: pointer;
        transition: background-color 0.3s ease-in-out;
        font-size: 20px;
        font-weight: 500;
      }

      button:hover {
        background-color: #6B56D6;
        /* transform: translateY(-2px); */
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-gap: 30px;
        align-items: center;
      }

      canvas {
        border: none; /* Remove border as per design */
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* Subtle shadow instead */
        border-radius: 15px;
        background-color: #000;
      }

      nav a {
        text-decoration: none; 
        color: #0a0a0a; 
        font-size: 18px;
        padding: 5px 20px; /* Added padding to make the background visible */
        border-radius: 50px; /* Optional: rounds the corners */
        transition: color 0.3s ease, background-color 0.3s ease;
      }

      nav a:hover {
        background-color: #0a0a0a;
        color: #FFFFFF;
      }

      header {
        max-width: 90%;
        margin: 0;
        padding: 20px 40px; /* 20px top/bottom, 40px left/right */
      }
    </style>
  </head>
  <body>
    <header
      style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 0px;
        width: 100%;
      "
    >
      <div class="logo">
        <img src="logo.png" alt="Rawsam Logo" style="height: 40px" />
      </div>

      <nav style="display: flex; gap: 30px">
        <a
          href="https://readymag.website/u54360863/5090068/"
          style="text-decoration: none; font-size: 18px"
          >عن روسم</a
        >
        <a
          href="#"
          style="text-decoration: none; font-size: 18px"
          >مجتمعنا</a
        >
        <a
          href="#"
          style="text-decoration: none; font-size: 18px"
          >أعمالنا</a
        >
        <a
          href="#"
          style="text-decoration: none; font-size: 18px"
          >تواصل معنا</a
        >
      </nav>
    </header>

    <!-- <h1>روسم</h1> -->
    <!-- <p>
      Sketch freely on the canvases and click "Generate GIF" to save your
      sketches as a GIF.
    </p> -->

    <div class="container" style="display: flex; flex-direction: column; align-items: center">
      <div style="text-align: center; margin-top: 50px;">
        <div
          id="colorPicker"
          style="
            display: flex;
            flex-direction: row;
            gap: 10px;
            justify-content: center;
          "
        >
          <button
            style="
              background-color: #f6f6f6;
              width: 30px;
              height: 30px;
              border: none;
              cursor: pointer;
            "
            data-color="#f6f6f6"
          ></button>
          <!-- <button
            style="
              background-color: #b0e49f;
              width: 30px;
              height: 30px;
              border: none;
              cursor: pointer;
            "
            data-color="#b0e49f"
          ></button> -->
          <button
            style="
              background-color: #ff9a22;
              width: 30px;
              height: 30px;
              border: none;
              cursor: pointer;
            "
            data-color="#FF9A22"
          ></button>
          <button
            style="
              background-color: #6B56D6;
              width: 30px;
              height: 30px;
              border: none;
              cursor: pointer;
            "
            data-color="#876BF5"
          ></button>
          <button
            style="
              background-color: #636363;
              width: 30px;
              height: 30px;
              border: none;
              cursor: pointer;
            "
            data-color="#636363"
          ></button>
        </div>
      </div>
      <div>
        <div style="display: flex; gap: 20px; align-items: center">
          <div style="text-align: center">
            <h3>الرسمة الأولى</h3>
            <canvas id="canvas1" width="400" height="400"></canvas>
          </div>
          <div style="text-align: center">
            <h3>الرسمة الثانية</h3>
            <canvas id="canvas2" width="400" height="400"></canvas>
          </div>
          <div style="text-align: center">
            <h3>الرسمة الثالثة</h3>
            <canvas id="canvas3" width="400" height="400"></canvas>
          </div>
        </div>
      </div>
    </div>

    <div style="margin-top: 30px; text-align: center">
      <button id="generateGifBtn">انتهيت</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/2.0.1/gif.min.js"></script>
    <script>
      // Set up canvases and context
      const canvases = [
        document.getElementById("canvas1"),
        document.getElementById("canvas2"),
        document.getElementById("canvas3"),
      ];
      const contexts = canvases.map((canvas) => canvas.getContext("2d"));
      let drawing = false;
      let currentCanvas = null;
      let currentColor = "#FF9A22"; // Default color

      contexts.forEach((context) =>
        context.clearRect(0, 0, context.canvas.width, context.canvas.height)
      );

      // Set up drawing on each canvas
      canvases.forEach((canvas, index) => {
        canvas.addEventListener("mousedown", (e) => {
          drawing = true;
          currentCanvas = contexts[index];
          currentCanvas.beginPath(); // Start a new path for each stroke
          currentCanvas.strokeStyle = currentColor; // Set the current color
          currentCanvas.moveTo(e.offsetX, e.offsetY);
        });

        canvas.addEventListener("mousemove", (e) => {
          if (drawing) {
            currentCanvas.lineTo(e.offsetX, e.offsetY);
            currentCanvas.stroke();
          }
        });

        canvas.addEventListener("mouseup", () => {
          drawing = false;
          if (currentCanvas) {
            currentCanvas.closePath(); // Close the path when done drawing
          }
        });

        canvas.addEventListener("mouseleave", () => {
          drawing = false;
          if (currentCanvas) {
            currentCanvas.closePath(); // Close the path when leaving canvas
          }
        });

        // Set initial styles for drawing
        contexts[index].lineWidth = 10;
        contexts[index].lineJoin = "round";
        contexts[index].lineCap = "round";
      });

      // Set up color picker
      const colorPicker = document.getElementById("colorPicker");
      colorPicker.addEventListener("click", (e) => {
        if (e.target.tagName === "BUTTON") {
          currentColor = e.target.getAttribute("data-color"); // Only update the current color
        }
      });

      // Function to create a GIF from canvas drawings
      function generateGif() {
        const gif = new GIF({
          workers: 2,
          quality: 10,
          width: 300,
          height: 300,
          workerScript: "gif.worker.js",
        });

        // Add frames from each canvas
        canvases.forEach((canvas, index) => {
          const imageData = contexts[index].getImageData(
            0,
            0,
            canvas.width,
            canvas.height
          );
          const data = imageData.data;
          console.log(data);
          console.log(canvas.width, canvas.height);

          // Check if the canvas has any non-transparent pixels
          const hasContent = data.some((pixel) => pixel !== 0);

          if (hasContent) {
            gif.addFrame(canvas, { delay: 200 });
          }
        });

        gif.on("finished", function (blob) {
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = "sketches.gif";
          a.click();
        });

        gif.render();
      }

      // Event listener for the generate GIF button
      document
        .getElementById("generateGifBtn")
        .addEventListener("click", generateGif);
    </script>
  </body>
</html>
